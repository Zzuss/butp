# 阿里云预测API测试指南

## 🎯 测试页面位置
访问测试页面：`/test-aliyun-prediction`

## 📝 使用步骤

### 1. 配置服务器地址
1. 打开测试页面
2. 在"API服务器配置"部分输入你的阿里云服务器地址
3. 格式示例: `http://116.62.xxx.xxx:8080`

### 2. 健康检查
1. 点击"健康检查"按钮
2. 确认服务器状态正常
3. 预期返回: 包含服务状态信息的JSON响应

### 3. 获取专业列表
1. 点击"获取专业列表"按钮
2. 查看支持的专业列表
3. 预期返回: 显示所有可用专业的列表

### 4. 测试预测功能
1. 选择一个Excel格式的成绩文件
2. 从下拉列表中选择专业
3. 点击"开始预测"按钮
4. 等待预测结果

## 📊 API接口说明

### 健康检查
- **接口**: `GET /health`
- **描述**: 检查服务器运行状态
- **返回**: 服务器状态信息

### 专业列表
- **接口**: `GET /api/majors`
- **描述**: 获取支持的专业列表
- **返回**: `{ "data": { "majors": ["专业1", "专业2"] } }`

### 单专业预测
- **接口**: `POST /api/predict`
- **参数**:
  - `scores_file`: Excel文件 (multipart/form-data)
  - `major`: 专业名称
  - `config`: 预测配置 (JSON字符串)
- **返回**: 预测结果数据

### 批量预测
- **接口**: `POST /api/predict/batch`
- **参数**:
  - `scores_file`: Excel文件 (multipart/form-data)
  - `majors`: 专业列表 (JSON数组)
  - `config`: 预测配置 (JSON字符串)
- **返回**: 批量预测结果

## 📁 文件要求

### Excel文件格式
- 支持格式: `.xlsx`, `.xls`
- 最大大小: 50MB
- 内容要求: 包含学生成绩数据

### 配置参数
```json
{
  "min_grade": 60,
  "max_grade": 90,
  "with_uniform_inverse": 1
}
```

## 🔧 故障排除

### 常见错误

#### 1. 网络连接错误
- **问题**: `网络错误: Failed to fetch`
- **解决**: 检查服务器地址是否正确，确保服务器运行正常

#### 2. 请求超时
- **问题**: `请求超时，预测可能需要较长时间`
- **解决**: 预测时间较长是正常现象，可以等待或减少数据量

#### 3. 文件格式错误
- **问题**: `请上传有效的Excel文件`
- **解决**: 确保文件格式为.xlsx或.xls

#### 4. 专业不支持
- **问题**: 预测失败，专业不在支持列表中
- **解决**: 先获取专业列表，确认专业名称正确

### 检查清单
- [ ] 阿里云服务器正在运行
- [ ] 安全组已开放8080端口
- [ ] 服务器防火墙已配置
- [ ] Nginx和Gunicorn服务正常启动
- [ ] API地址格式正确

## 📈 测试建议

1. **先测试健康检查**: 确保基本连接正常
2. **获取专业列表**: 确认API功能正常
3. **小文件测试**: 先用小的Excel文件测试预测功能
4. **观察日志**: 查看浏览器控制台的详细日志信息

## 🚀 部署架构
```
前端(Next.js) → Nginx(8080) → Gunicorn(8001) → Flask API → 预测算法
```

## 📞 技术支持

如果遇到问题，请提供以下信息：
1. 浏览器控制台错误信息
2. 服务器日志
3. 使用的文件大小和格式
4. 选择的专业名称

---

**注意**: 请确保你的阿里云服务器已正确部署，并且所有服务正常运行。
